<!doctype html>
<html lang="en">
  <head>
    <title>Document</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  </head>
  <body>
    <div class="container mt-4">
      <div class="row">
        <div class="col-md-8">
          <h1 class="mb-4">Todo List</h1>
          <ul class="list-group fs-5">
            <ul class="list-group fs-5 me-5" id="todo-list">
              {{ range .Todos }} {{ block "todo-list-element" . }}
              <li
                class="list-group-item border border-primary text-black mb-2 rounded d-flex justify-content-between w-full"
                id="todo-item-{{ .Id }}"
              >
                #{{ .Id }} {{ .Title }} - {{ if .Status }}To
                do!{{else}}Done{{end}}
                <div class="ml-auto w-auto">
                  <button
                    class="btn btn-secondary"
                    hx-put="/toggle-todo"
                    hx-target="#todo-item-{{ .Id }}"
                    hx-indicator="#spinner-put-{{ .Id }}"
                    hx-swap="outerHTML"
                    hx-vals='{"taskID": {{ .Id }}}'
                  >
                    <span
                      class="spinner-border spinner-border-sm htmx-indicator"
                      id="spinner-put-{{ .Id }}"
                    ></span>
                    Mark as {{ if .Status }}complete{{ else }}to-do{{ end }}
                  </button>

                  <button
                    class="btn btn-danger"
                    hx-delete="/delete-todo/{{ .Id}}"
                    hx-target="#todo-item-{{ .Id }}"
                    hx-indicator="#spinner-delete-{{ .Id }}"
                    hx-swap="outerHTML"
                    hx-vals='{"taskID": {{ .Id }}}'
                  >
                    <span
                      class="spinner-border spinner-border-sm htmx-indicator"
                      id="spinner-delete-{{ .Id }}"
                    ></span>
                    Delete {{ .Id }}
                  </button>
                </div>
              </li>
              {{ end }}{{ end }}
            </ul>
          </ul>
        </div>

        <div class="col-md-4">
          <h1 class="mb-4">Add Todo</h1>
          <form
            hx-post="/add-todo/"
            hx-target="#todo-list"
            hx-swap="beforeend"
            hx-indicator="#spinner"
          >
            <div class="mb-3">
              <label for="todo-title" class="form-label">Title</label>
              <input
                type="text"
                name="title"
                id="todo-title"
                class="form-control"
                required
              />
            </div>
            <button class="btn btn-primary" type="submit">
              <span
                class="spinner-border spinner-border-sm htmx-indicator"
                id="spinner"
              ></span>
              Submit
            </button>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>
